---
id: 20250807-rYE_.uZOc
title: Implement Apple Sign-In backend integration
created: '2025-08-07'
updated: '2025-08-07'
spec: 20250807-rYE_
project: auth
status: done
archived: false
---

Implement server-side Apple Sign-In integration with full cross-platform support (iOS/macOS/web).

## Requirements
- Add POST /auth/apple endpoint for new user sign-in
- Add POST /auth/link-apple endpoint for linking to existing accounts
- Validate Apple ID tokens from client
- Create JWT tokens for authenticated users
- Support iOS, macOS, and web Apple Sign-In flows

## Implementation Details
- Integrate with Apple's Identity Services API
- Validate Apple ID tokens using Apple's public keys
- Extract user information (apple_id, email if provided)
- Handle Apple's privacy-focused email relay
- Create user records with auth_method='apple'
- Generate Gatz JWT tokens for authenticated sessions

## Security Considerations
- Verify Apple ID token signatures
- Validate token audience and issuer
- Handle token expiration and refresh
- Rate limiting on auth endpoints

## Acceptance Criteria
- [ ] POST /auth/apple endpoint accepts Apple ID tokens
- [ ] Apple ID token validation works correctly
- [ ] New users can sign up with Apple Sign-In
- [ ] JWT tokens generated for Apple Sign-In users
- [ ] Works across iOS, macOS, and web platforms
- [ ] Error handling for invalid/expired tokens