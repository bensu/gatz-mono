---
id: 20250807-rYE_.SoyG
title: Conditional SMS Sign-In Based on Backend Configuration
created: '2025-08-08'
updated: '2025-08-08'
spec: 20250807-rYE_
project: auth
status: todo
archived: false
---

Add conditional SMS authentication that can be enabled/disabled via a hardcoded configuration flag in the backend. The SMS sign-in option will only be displayed when the backend manifest includes the enabled flag.

**Backend Changes:**
1. Add `config_flags` object to manifest in `server/src/gatz/settings.clj`
2. Include hardcoded `allow_sms_authentication` boolean flag
3. Extend manifest response structure

**Frontend Changes:**
1. Update manifest type definitions to include `config_flags` with `allow_sms_authentication`
2. Add SMS sign-in button to `SocialSignInButtons` component with conditional rendering
3. Implement SMS authentication flow using existing `/verify/start` and `/verify/code` endpoints
4. Use existing manifest fetching system (no changes needed)
5. Maintain current button layout order

**Technical Details:**
- Use existing phone verification endpoints for SMS auth flow
- No manifest caching changes required
- No fallback handling needed (app won't render if manifest fails)
- SMS button added conditionally without changing existing layout

**Acceptance Criteria:**
- SMS sign-in button appears only when `config_flags.allow_sms_authentication: true` in manifest
- Button is hidden when flag is `false` or missing
- SMS authentication works using existing phone verification flow
- No breaking changes to existing authentication methods
- Maintains current UI layout and button ordering